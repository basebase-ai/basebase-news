<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StoryList - Your news dashboard</title>
    <script
      defer
      data-domain="storylist.org"
      src="https://plausible.io/js/script.outbound-links.tagged-events.js"
    ></script>
    <script>
      window.plausible =
        window.plausible ||
        function () {
          (window.plausible.q = window.plausible.q || []).push(arguments);
        };
    </script>

    <meta
      name="description"
      content="Stay informed with StoryList - Your personalized news dashboard that brings the world's headlines to you at a glance."
    />
    <meta property="og:title" content="StoryList - Your news dashboard" />
    <meta
      property="og:description"
      content="Stay informed with StoryList - Your personalized news dashboard that brings the world's headlines to you at a glance."
    />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/assets/images/icon_256x256.png" />
    <meta property="og:url" content="https://www.storylist.org" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="StoryList - Your news dashboard" />
    <meta
      name="twitter:description"
      content="Stay informed with StoryList - Your personalized news dashboard that brings the world's headlines to you at a glance."
    />
    <meta name="twitter:image" content="/assets/images/icon_256x256.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/assets/images/icon_32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="128x128"
      href="/assets/images/icon_128x128.png"
    />
    <link rel="apple-touch-icon" href="/assets/images/icon_256x256.png" />
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: { primary: "#1a56db", secondary: "#4f46e5" },
            borderRadius: {
              none: "0px",
              sm: "4px",
              DEFAULT: "8px",
              md: "12px",
              lg: "16px",
              xl: "20px",
              "2xl": "24px",
              "3xl": "32px",
              full: "9999px",
              button: "8px",
            },
          },
        },
      };
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;0,900;1,400&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link href="/css/styles.css" rel="stylesheet" />
  </head>
  <body class="min-h-screen bg-white dark:bg-gray-950">
    <!-- Source Settings Modal -->
    <div
      id="sourceSettingsModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center p-4"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col"
      >
        <div class="flex justify-between items-center mb-4">
          <h3
            id="modalTitle"
            class="text-xl font-bold font-poppins text-gray-900 dark:text-white"
          >
            Source Settings
          </h3>
          <button
            onclick="sourceService.closeSourceSettingsModal()"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 w-8 h-8 flex items-center justify-center"
          >
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <form
          id="sourceSettingsForm"
          onsubmit="sourceService.handleSourceSubmit(event)"
          class="space-y-4 font-poppins overflow-y-auto flex-1 custom-scrollbar pr-2"
        >
          <input type="hidden" id="sourceId" />
          <div id="objectIdField" class="hidden">
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Object ID</label
            >
            <input
              type="text"
              id="displayObjectId"
              readonly
              class="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-500 dark:text-gray-400 cursor-not-allowed"
            />
          </div>
          <div>
            <label
              for="name"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Name</label
            >
            <input
              type="text"
              id="name"
              name="name"
              required
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="homepageUrl"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Homepage URL</label
            >
            <input
              type="url"
              id="homepageUrl"
              name="homepageUrl"
              required
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="rssUrl"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >RSS URL (optional)</label
            >
            <input
              type="url"
              id="rssUrl"
              name="rssUrl"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="includeSelector"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Include Selector (optional)</label
            >
            <input
              type="text"
              id="includeSelector"
              name="includeSelector"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="excludeSelector"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Exclude Selector (optional)</label
            >
            <input
              type="text"
              id="excludeSelector"
              name="excludeSelector"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="biasScore"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Bias Score (optional)</label
            >
            <input
              type="number"
              id="biasScore"
              name="biasScore"
              step="0.01"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="tags"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Tags (comma separated)</label
            >
            <input
              type="text"
              id="tags"
              name="tags"
              placeholder="politics, technology, local"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"
            />
          </div>
          <div>
            <label
              for="imageUrl"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Image URL (optional)</label
            >
            <input
              type="url"
              id="imageUrl"
              name="imageUrl"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div class="flex items-center">
            <input
              type="checkbox"
              id="hasPaywall"
              name="hasPaywall"
              class="h-4 w-4 text-blue-600 rounded border-gray-300 dark:border-gray-600 focus:ring-blue-500"
            />
            <label
              for="hasPaywall"
              class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300"
              >Has Paywall</label
            >
          </div>
          <div class="flex justify-end space-x-3 pt-4">
            <button
              type="button"
              onclick="sourceService.closeSourceSettingsModal()"
              class="px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              id="submitButton"
              class="px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors"
            >
              Update
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- New Source Modal -->
    <div
      id="newSourceModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center"
    >
      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-lg">
        <div class="flex justify-between items-center mb-4">
          <h3
            class="text-xl font-bold font-poppins text-gray-900 dark:text-white"
          >
            Add New Source
          </h3>
          <button
            onclick="sourceService.closeNewSourceModal()"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <form
          id="newSourceForm"
          onsubmit="sourceService.handleNewSourceSubmit(event)"
          class="space-y-4 font-poppins"
        >
          <div>
            <label
              for="newSourceName"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Name</label
            >
            <input
              type="text"
              id="newSourceName"
              name="name"
              placeholder="New York Times"
              required
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="newSourceHomepageUrl"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Homepage URL</label
            >
            <input
              type="url"
              id="newSourceHomepageUrl"
              name="homepageUrl"
              placeholder="https://www.nytimes.com"
              required
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div>
            <label
              for="newSourceRssUrl"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >RSS URL
              <span class="text-sm font-normal text-gray-500 dark:text-gray-400"
                >(optional)</span
              ></label
            >
            <input
              type="url"
              id="newSourceRssUrl"
              name="rssUrl"
              placeholder="https://www.nytimes.com/rss/feed.xml"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            />
          </div>
          <div class="text-sm text-gray-500 dark:text-gray-400 italic">
            If no RSS feed URL is provided, Storylist will try to find it based
            on the homepage.
          </div>
          <div class="flex justify-end space-x-3 pt-4">
            <button
              type="button"
              onclick="sourceService.closeNewSourceModal()"
              class="px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors"
            >
              Add
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Delete Source Confirmation Modal -->
    <div
      id="deleteSourceModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center"
    >
      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-lg">
        <div class="flex justify-between items-center mb-4">
          <h3
            class="text-xl font-bold font-poppins text-gray-900 dark:text-white"
          >
            Delete Source
          </h3>
          <button
            onclick="sourceService.closeDeleteSourceModal()"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <div class="space-y-4 font-poppins">
          <p class="text-gray-700 dark:text-gray-300">
            Are you sure you want to delete this source? This action cannot be
            undone.
          </p>
          <div class="flex justify-end space-x-3 pt-4">
            <button
              type="button"
              onclick="sourceService.closeDeleteSourceModal()"
              class="px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
            >
              Cancel
            </button>
            <button
              id="confirmDeleteButton"
              class="px-4 py-2 text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Sign In Modal -->
    <div
      id="signInModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"
    >
      <div class="bg-white rounded-lg p-6 w-full max-w-lg">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold font-poppins">Sign In</h3>
          <button
            onclick="closeSignInModal()"
            class="text-gray-500 hover:text-gray-700"
          >
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <div id="signInFormContainer">
          <form
            id="signInForm"
            onsubmit="handleSignInSubmit(event)"
            class="space-y-4 font-poppins"
          >
            <div>
              <label
                for="firstName"
                class="block text-sm font-medium text-gray-700 mb-1"
                >First Name</label
              >
              <input
                type="text"
                id="firstName"
                name="firstName"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>
            <div>
              <label
                for="lastName"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Last Name</label
              >
              <input
                type="text"
                id="lastName"
                name="lastName"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>
            <div>
              <label
                for="email"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Email</label
              >
              <input
                type="email"
                id="email"
                name="email"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>
            <div class="flex justify-end space-x-3 pt-4">
              <button
                type="button"
                onclick="closeSignInModal()"
                class="px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors"
              >
                Cancel
              </button>
              <button
                type="submit"
                id="signInSubmitButton"
                class="px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors"
              >
                Continue
              </button>
            </div>
          </form>
        </div>
        <div id="signInConfirmation" class="hidden font-poppins">
          <div class="text-center py-4">
            <i class="ri-mail-line text-4xl text-blue-600 mb-4"></i>
            <h3 class="text-xl font-bold mb-2">Check your email</h3>
            <p class="text-gray-600 mb-4">
              We've sent a special sign-in link to your email address. Click the
              link to complete signing in.
            </p>
            <button
              onclick="closeSignInModal()"
              class="px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <header
      class="fixed top-0 left-0 right-0 bg-white dark:bg-gray-950 z-50 border-b border-gray-200 dark:border-gray-800 shadow-sm"
    >
      <div class="flex items-center px-4 py-3">
        <img
          src="/assets/images/logotype_541x110.png"
          alt="StoryList"
          class="w-[132px] mr-2"
        />
        <div class="flex-1"></div>
        <div class="relative mr-2">
          <input
            type="text"
            id="searchInput"
            placeholder="Search"
            class="w-32 md:w-48 lg:w-64 min-w-24 pl-3 pr-2 py-1.5 border border-gray-300 dark:border-gray-600 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 font-poppins text-[0.9em] bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"
          />
          <button
            id="searchClearButton"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hidden w-8 h-8 flex items-center justify-center"
            onclick="headlineService.clearSearch()"
          >
            <i class="ri-close-line text-2xl"></i>
          </button>
          <button
            id="searchIcon"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 w-8 h-8 flex items-center justify-center"
          >
            <i class="ri-search-line text-2xl"></i>
          </button>
        </div>
        <div id="userSection" class="hidden flex items-center">
          <button
            onclick="openCustomizeModal()"
            class="text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-gray-100 font-poppins text-sm mr-2 border border-gray-300 dark:border-gray-600 rounded-md w-8 h-8 flex items-center justify-center hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
          >
            <i class="ri-settings-3-line text-2xl"></i>
          </button>
          <div
            id="userAvatar"
            class="w-8 h-8 rounded-full overflow-hidden flex items-center justify-center text-white font-medium text-sm font-poppins cursor-pointer"
            onclick="console.log('Avatar clicked from HTML');"
          ></div>
        </div>
        <button
          id="signInButton"
          onclick="openSignInModal()"
          class="text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-gray-100 font-poppins text-sm border border-gray-300 dark:border-gray-600 rounded-md w-8 h-8 flex items-center justify-center hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
        >
          <i class="ri-settings-3-line text-2xl"></i>
        </button>
      </div>
    </header>
    <main class="pt-24 bg-gray-100 dark:bg-gray-950 min-h-screen">
      <div
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 px-4 mx-auto grid pb-20"
      >
        <!-- Content will be dynamically populated here -->
      </div>
    </main>

    <!-- Customize Sources Modal -->
    <div
      id="customizeModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center px-8"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col"
      >
        <div class="flex justify-between items-center mb-6">
          <h3
            class="text-xl font-bold font-poppins text-gray-900 dark:text-white"
          >
            Customize Your News Sources
          </h3>
          <button
            onclick="closeCustomizeModal()"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <div class="relative mb-6">
          <div class="flex items-center gap-4">
            <div class="relative flex-1">
              <input
                type="text"
                id="sourceSearchInput"
                placeholder="Search"
                class="w-full px-4 py-1.5 border border-gray-300 dark:border-gray-600 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 font-poppins text-[0.9em] bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"
              />
              <button
                class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300"
              >
                <i class="ri-search-line"></i>
              </button>
            </div>
            <div id="addSourceButton" class="shrink-0">
              <button
                onclick="sourceService.openNewSourceModal()"
                class="text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-gray-100 font-poppins text-sm border border-gray-300 dark:border-gray-600 rounded-md px-3 py-1.5 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center"
              >
                New Source
              </button>
            </div>
          </div>
        </div>
        <div
          id="sourcesGrid"
          class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 overflow-y-auto flex-1 custom-scrollbar pb-[100px] bg-white dark:bg-gray-800/50"
        >
          <!-- Sources will be dynamically populated here -->
        </div>
        <div class="flex justify-end mt-6 pt-4 border-t border-gray-200">
          <button
            onclick="closeCustomizeModal()"
            class="px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors font-poppins text-sm"
          >
            Done
          </button>
        </div>
      </div>
    </div>

    <script src="/js/auth.js" type="module"></script>
    <script src="/js/sources.js" type="module"></script>
    <script src="/js/headlines.js" type="module"></script>
    <script src="/js/source-ui.js" type="module"></script>
    <script src="/js/main.js" type="module"></script>
    <script>
      // Wait for modules to load
      window.addEventListener("load", () => {
        if (!window.sourceService) {
          // sourceService not loaded
        }
      });
    </script>
  </body>
</html>
